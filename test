#!/usr/bin/env bash
#
# run_check.sh — invoke a PowerShell script and map its exit code

# Path to your PowerShell script
PS_SCRIPT="./Check-Tab1Load.ps1"

# (Optional) any arguments you need to pass through
PS_ARGS=(
  -TenantId     "your-tenant-guid"
  -ClientId     "your-spn-guid"
  -ClientSecret "your-client-secret"
  -Server       "yourserver.database.windows.net"
  -Database     "YourDatabase"
)

# 1) Run the PowerShell check
pwsh -NoProfile -NonInteractive -File "$PS_SCRIPT" "${PS_ARGS[@]}"

# 2) Grab its exit code
rc=$?

# 3) Print and branch
if [ "$rc" -eq 0 ]; then
  echo "✔ SUCCESS: PowerShell exited 0"
else
  echo "✖ FAILURE: PowerShell exited $rc" >&2
fi

# 4) Propagate the exit code
exit "$rc"
